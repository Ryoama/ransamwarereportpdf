# 拡張セキュリティ設定要件定義書

岡山県精神科医療センターのランサムウェア調査報告書に基づいた包括的なセキュリティ要件

## 1. アカウント管理

### 1.1 パスワードポリシー
- 最小パスワード長: 15文字（報告書では12文字だが、より強固に設定）
- パスワード複雑性: 有効（大文字・小文字・数字・特殊文字を含む）
- パスワード履歴: 24個を記憶
- パスワード有効期限: 90日
- パスワード変更禁止期間: 1日

### 1.2 アカウントロックアウトポリシー
- ロックアウトのしきい値: 5回の無効なログオン試行
- ロックアウト期間: 30分
- ロックアウトカウンターのリセット: 30分後

### 1.3 特権アカウント管理
- Built-in Administratorアカウント: 無効化、名前変更、パスワードのランダム化（25文字）
- Guestアカウント: 無効化
- LAPS（Local Administrator Password Solution）の導入

## 2. 認証設定

### 2.1 NTLM設定
- LmCompatibilityLevel: 5（NTLMv2のみ許可）
- NTLMの使用を最小限に制限

### 2.2 Kerberos設定
- 最大チケット有効期間: 10時間
- 最大更新期間: 7日間

## 3. ネットワークセキュリティ

### 3.1 SMB設定
- SMBv1プロトコル: 無効化
- SMB署名: 必須（サーバー・クライアント両方）
- SMB暗号化: 有効

### 3.2 RDP設定
- ポート番号: 3390に変更（デフォルト3389から変更）
- Network Level Authentication (NLA): 有効
- 最低暗号化レベル: High
- Remote Desktop Usersグループ: 最小限のユーザーのみ

### 3.3 DNS設定
- セキュアDNSリゾルバー: Quad9（9.9.9.9, 149.112.112.112）
- マルウェア・フィッシングサイトのブロック

### 3.4 NetBIOS設定
- NodeType: 2（P-node: ピアツーピア）に設定

## 4. セキュリティポリシー

### 4.1 UAC（ユーザーアカウント制御）
- PromptOnSecureDesktop: 有効
- ConsentPromptBehaviorAdmin: 2（資格情報の入力を要求）
- EnableLUA: 有効

### 4.2 匿名アクセス制限
- RestrictAnonymous: 1
- RestrictAnonymousSAM: 1
- EveryoneIncludesAnonymous: 0

## 5. Windows Defender設定

### 5.1 Attack Surface Reduction (ASR) ルール
- Office系マクロの実行ブロック
- スクリプト系の悪用防止
- プロセス挿入のブロック
- 署名されていない実行ファイルのブロック

### 5.2 リアルタイム保護
- リアルタイムスキャン: 有効
- 動作監視: 有効
- ネットワーク検査システム: 有効

## 6. ログとモニタリング

### 6.1 イベントログ設定
- セキュリティログサイズ: 1GB
- システムログサイズ: 1GB
- アプリケーションログサイズ: 1GB
- ログの上書き設定: 必要に応じてアーカイブ

### 6.2 Windows Firewall
- すべてのプロファイル: 有効
- デフォルトインバウンド: ブロック
- ログ記録: 有効（ブロックと許可両方）

## 7. アプリケーション制御

### 7.1 PowerShell
- 実行ポリシー: AllSigned（署名されたスクリプトのみ実行）
- PowerShell 7も同様に設定

### 7.2 VBAマクロ
- 電子署名されたマクロのみ実行許可
- グループポリシーでOfficeアドインを制限

## 8. 物理セキュリティとデータ保護

### 8.1 USBストレージ
- 病院指定のウイルス対策ソフト内蔵USBメモリのみ許可
- グループポリシーで制御

### 8.2 ディスク暗号化
- BitLockerの使用を推奨
- TPMとPINの組み合わせ

## 9. 定期的なメンテナンス

### 9.1 パッチ管理
- Windows Update: 月次適用
- 段階的適用（重要度の低いシステムから）

### 9.2 脆弱性スキャン
- 定期的な脆弱性スキャンの実施
- 特にVPN装置の脆弱性確認

## 10. 組織的対策

### 10.1 セキュリティ教育
- フィッシング対策教育の実施
- パスワード管理の重要性の周知

### 10.2 インシデント対応
- インシデント対応計画の策定
- 定期的な訓練の実施

## 実装の優先順位

1. **緊急**: パスワードポリシー、Built-in Administrator無効化、SMBv1無効化
2. **高**: NTLM制限、RDP設定変更、Windows Defender ASR
3. **中**: ログ設定、DNS設定、UAC強化
4. **計画的**: LAPS導入、802.1X認証、BitLocker展開

## 注意事項

- すべての設定は事前にテスト環境で検証すること
- 医療システムとの互換性を確認すること
- ベンダーとの調整が必要な項目は事前に協議すること
- 段階的な適用を心がけ、システムへの影響を最小限にすること